<!DOCTYPE html>
<!--[if IE 7]>
<html class="ie ie7" lang="zh-CN">
<![endif]-->
<!--[if IE 8]>
<html class="ie ie8" lang="zh-CN">
<![endif]-->
<!--[if !(IE 7) & !(IE 8)]><!-->
<html lang="zh-CN">
<!--<![endif]-->
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width" />
<title>BestCoder Blog | BestCoder 官方博客</title>
<link rel="profile" href="http://gmpg.org/xfn/11" />
<link rel="pingback" href="http://bestcoder.hdu.edu.cn/blog/xmlrpc.php" />
<!--[if lt IE 9]>
<script src="http://bestcoder.hdu.edu.cn/blog/wp-content/themes/twentytwelve/js/html5.js" type="text/javascript"></script>
<![endif]-->
<link rel="alternate" type="application/rss+xml" title="BestCoder Blog &raquo; Feed" href="http://bestcoder.hdu.edu.cn/blog/feed/" />
<link rel="alternate" type="application/rss+xml" title="BestCoder Blog &raquo; 评论Feed" href="http://bestcoder.hdu.edu.cn/blog/comments/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/bestcoder.hdu.edu.cn\/blog\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.5.3"}};
			!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;if(!g||!g.fillText)return!1;switch(g.textBaseline="top",g.font="600 32px Arial",a){case"flag":return g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3;case"diversity":return g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,d=c[0]+","+c[1]+","+c[2]+","+c[3],g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e;case"simple":return g.fillText(h(55357,56835),0,0),0!==g.getImageData(16,16,1,1).data[0];case"unicode8":return g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='twentytwelve-style-css'  href='http://bestcoder.hdu.edu.cn/blog/wp-content/themes/twentytwelve/style.css?ver=4.5.3' type='text/css' media='all' />
<!--[if lt IE 9]>
<link rel='stylesheet' id='twentytwelve-ie-css'  href='http://bestcoder.hdu.edu.cn/blog/wp-content/themes/twentytwelve/css/ie.css?ver=20121010' type='text/css' media='all' />
<![endif]-->
<script type='text/javascript' src='http://bestcoder.hdu.edu.cn/blog/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='http://bestcoder.hdu.edu.cn/blog/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<link rel='https://api.w.org/' href='http://bestcoder.hdu.edu.cn/blog/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://bestcoder.hdu.edu.cn/blog/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://bestcoder.hdu.edu.cn/blog/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 4.5.3" />
<link rel="icon" href="http://bestcoder.hdu.edu.cn/blog/wp-content/uploads/2015/08/cropped-logo-32x32.png" sizes="32x32" />
<link rel="icon" href="http://bestcoder.hdu.edu.cn/blog/wp-content/uploads/2015/08/cropped-logo-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon-precomposed" href="http://bestcoder.hdu.edu.cn/blog/wp-content/uploads/2015/08/cropped-logo-180x180.png" />
<meta name="msapplication-TileImage" content="http://bestcoder.hdu.edu.cn/blog/wp-content/uploads/2015/08/cropped-logo-270x270.png" />
</head>

<body class="home blog">
<div id="page" class="hfeed site">
	<header id="masthead" class="site-header" role="banner">
		<hgroup>
			<h1 class="site-title"><a href="http://bestcoder.hdu.edu.cn/blog/" title="BestCoder Blog" rel="home">BestCoder Blog</a></h1>
			<h2 class="site-description">BestCoder 官方博客</h2>
		</hgroup>

		<nav id="site-navigation" class="main-navigation" role="navigation">
			<button class="menu-toggle">菜单</button>
			<a class="assistive-text" href="#content" title="跳至内容">跳至内容</a>
			<div class="menu-%e9%a1%b6%e9%83%a8%e5%af%bc%e8%88%aa%e6%9d%a1-container"><ul id="menu-%e9%a1%b6%e9%83%a8%e5%af%bc%e8%88%aa%e6%9d%a1" class="nav-menu"><li id="menu-item-13" class="menu-item menu-item-type-custom menu-item-object-custom current-menu-item current_page_item menu-item-home menu-item-13"><a href="http://bestcoder.hdu.edu.cn/blog/">首页</a></li>
<li id="menu-item-15" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15"><a href="http://bestcoder.hdu.edu.cn">BestCoder</a></li>
<li id="menu-item-16" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-16"><a href="http://acm.hdu.edu.cn">HDOJ</a></li>
</ul></div>		</nav><!-- #site-navigation -->

			</header><!-- #masthead -->

	<div id="main" class="wrapper">
	<div id="primary" class="site-content">
		<div id="content" role="main">
		
										
	<article id="post-378" class="post-378 post type-post status-publish format-standard hentry category-duoxiao">
				<header class="entry-header">
			
						<h1 class="entry-title">
				<a href="http://bestcoder.hdu.edu.cn/blog/2016-multi-university-training-contest-2-solutions-by-zimpha/" rel="bookmark">2016 Multi-University Training Contest 2 solutions BY zimpha</a>
			</h1>
										<div class="comments-link">
					<a href="http://bestcoder.hdu.edu.cn/blog/2016-multi-university-training-contest-2-solutions-by-zimpha/#respond"><span class="leave-reply">发表回复</span></a>				</div><!-- .comments-link -->
					</header><!-- .entry-header -->

				<div class="entry-content">
			<p># Acperience</p>
<p>展开式子, $\left\| W &#8211; \alpha B \right\|^2=\displaystyle\alpha^2\sum_{i=1}^{n}b_i^2-2\alpha\sum_{i=1}^n{w_ib_i}+\sum_{i=1}^{n}w_i^2$.</p>
<p>由于$b_i\in \{+1,-1\}$, 那么$\displaystyle\sum_{i=1}^{n}b_i^2=n$, 显然$c=\displaystyle\sum_{i=1}^{n}w_i^2$也是常数. 转化成求$\displaystyle\alpha^2n-2\alpha\sum_{i=1}^n{w_ib_i}+c$的最小值. 对于固定的$\alpha&gt;0$, 只要$\displaystyle\sum_{i=1}^n{w_ib_i}$最大就好了. 显然$b_i=sign(w_i)$的时候, $\displaystyle\sum_{i=1}^n{w_ib_i}=\sum_{i=1}^{n}|w_i|$最大. 进一步的, 上面显然是一个关于$\alpha$的二次方程, 于是当$\alpha=\frac{1}{n}\displaystyle\sum_{i=1}^n{w_ib_i}=\frac{1}{n}\displaystyle\sum_{i=1}^{n}{|w_i|}$时, 取到最大值.</p>
<p>化简下, 可以得到最小值是$\sum_{i=1}^n{w_i^2}-\frac{1}{n}(\displaystyle\sum_{i=1}^{n}|w_i|)^2$</p>
<p># Born Slippy</p>
<p>感谢叉姐在ICPCCamp上出的这道题最初的原型 &#8212; Data Structure You&#8217;ve Never Heard Of, 同样感谢Claris老师的教导.</p>
<p>由于and, or和xor方法都差不多, 这里仅考虑and操作. 不妨令$dp(s)=f(s)-w_s$, 我们大概要求的就是$dp(i)=\displaystyle\max_{j \text{ is ancestor of } i}\{dp(j)+w_i\text{ and }w_j\}$. 然后, 显然$dp(j)+w_i\text{ and }w_j$这个式子可以拆成$dp(j)$+[$w_i$后8位] and [$w_j$后8位] + ([$w_i$前8位] and [$w_j$前8位]) &lt;&lt; 8.</p>
<p>先考虑序列上应该如何做, 即求$dp(i)=\displaystyle\max_{j &lt; i}\{dp(j)+w_i\text{ and }w_j\}$. 考虑这样一个二维数组$ds(x,y)$, 表示对于某个$w_i$的后8位为$y$, 对于某个$w_j$的前8位为$x$时, $dp(j)$ + [$w_i$后8位] and [$w_j$后8位]的最值.</p>
<p>如果知道了上述数组, 那么对于某个$i$, 计算$dp(i)$的值就十分方便, 不妨令$w_i=(a &lt;&lt; 8) | b$, 即$a$和$b$分别是$w_i$前8位和后8位, 那么只需要枚举$w_j$的前8位$x$, 用$ds(x,b)+((a \text{ and } x) &lt;&lt; 8)$更新$dp(i)$. 把新的$dp$值更新到$ds(x,y)$也是类似的.</p>
<p>上述方法推广到树上也是十分简单, 由于每次更新$ds(x,y)$的时候只有数组的一维会变动(令$a$=$w_i$&gt;&gt;8, 那么只有$ds(a,\cdot)$会变化), 那么只要对数组的第一维做一个可持久化就好了(或者说边dfs边备份).</p>
<p># Call It What You Want</p>
<p>这个图大概就是一棵树, 然后最多加了5条边. 首先通过不断删掉度为1的点, 把这个图中属于树的部分全部砍掉, 那么我们会得到一个没有度等于1的点的图. 之后把图中度为2的点都缩掉, 最后得到一个图每个点的度至少为3. 显然最后得到的图最多只有8个点, 12条边(也许是10个点, 14条边, 但是随机出来的数据没有这种情况, 大概8个点12条边就是上界了吧).</p>
<p>考虑最长路的组成, 可以分为2种情况: 1. 在砍掉的树部分上; 2. 树上一条链+最终图上的一条路径+树上另一条链.</p>
<p>对于第一种情况, 在删度为1节点的时候就可以顺便计算出每个点$u$往下走的最长路$f_u$和次长路$g_u$, 显然答案就是$\max\{f_u+g_u\}$.</p>
<p>第二种情况有点复杂, 主要麻烦的地方在于多出来的2条链, 它们的位置有多种情况. 可能是在同一条边中延伸出来; 可能是在同一个环上延伸出来; 可能在两个不同的环上; 可能一个在环上, 另一个在普通边上. 根据这些情况, 大概要预处理出一些东西, 然后考虑枚举12条边的经过顺序, 然后在路径2边接上树上的链. 枚举经过顺序过程可以用状态压缩dp来优化. 需要注意的是最终图上的边也许会有重边.</p>
<p>Nero爷提供了一个比较暴力的方法, 和上面方法类似, 先把树上的一些东西都搞完, 接下来考虑多出的5条非树边. 那么可以5!暴力枚举这5条非树边的经过顺序(可能还要枚举下方向), 显然剩下来一定是要经过树边, 直接用树边把这些边接起来就好了(这里直接暴力bfs或者dfs就好了, 需要注意非树边上的点不要重复经过). 这个方法在测试的时候开长时限给放过了, 不知道比赛时候会不会因为一些不可知的原因而炸掉.</p>
<p># Differencia</p>
<p>感谢Claris老师教我如何卡常数 &#8212; 只要数据范围够大就好了.</p>
<p>这道题$O(n\log^2 n)$的线段树套有序表做法很显然. 线段树每个节点[l,r]维护这个区间内, 数组$b$排序好的结果. 然后对于修改操作, 只要在这个区间内二分一下就能知道这个区间的答案(往子节点push lazy标记时也同理). 这个做法常数很小, 跑的很快, 但是应该被卡了(没测过zkw写法, 也许能过), 理由参考第一句话.</p>
<p>上面方法稍作修改就可以得到一个$O(n\log n)$的做法, 除了有序表线段树每个节点同时维护有序表第$i$个数进入左右子树时的位置. 那么只要在线段树根节点做一次二分, 之后就可以$O(1)$查询这个数在左右子树的rank变化. 这个对线段树往下push lazy标记也是适用的.</p>
<p>这个题应该还可以用平衡树+可持久化线段树做到$O(n\log n)$. 平衡树每个点保存$a$以及这个区间$a_i-b_i \ge 0$的个数, 那么查询就是然后子树和. 考虑修改操作, 暴力从平衡树中拿出这些区间, 然后合并成同一个, 新区间的$a_i-b_i \ge 0$的个数等价于对$B$的区间查询, 用可持久化线段树维护即可. 出题人没测过这个方法, 大概能过吧.</p>
<p># Eureka</p>
<p>xjb推导一下可以知道best set一定是一些共线的点, 于是问题变成问有多少个子集共线. 首先, 把所有点按照$(x,y)$双关键字排序, 然后枚举最左边的点$i$, 那么其他点$j$一定满足$j &gt; i$. 把在这个点右边的点都做下极角排序(按照$\frac{1}{gcd(dx, dy)}(dx, dy)$排序), 统计下共线的就好了. 需要注意下对重点的处理.</p>
<p># Fantasia</p>
<p>显然, 只要删掉关键点才会使图不联通. 对于其他点, 权值很容易计算.</p>
<p>首先求出所有的点双联通分量, 对于每一个点双联通分量$S$, 新建一个节点$s$, 向$S$中每个节点$v$连边. 这样一来, 新增的点和原来图中的点会构成一个森林(据说这个有个名字, block forest data structure). 很容易观察到, 叶子节点肯定都是非关键点, 内部节点要么是关键点, 要么是新增的节点.</p>
<p>对于这个森林$F$, 删掉一个关键点或者一个叶子$i$之后, 会得到一个新森林$F_i$, 这个$F_i$对应的连通块集合和$G_i$对应的连通块集合其实是一样的(不考虑那些新增的点). 显然$G_i$的权值和$F_i$的权值也是一样的, $F_i$的权值我们很容易通过树形dp算出来, 那么$G_i$的权值也随之而出.</p>
<p># Glorious Brilliance</p>
<p>首先对图二分染色, 如果不是二分图, 显然是无解的.</p>
<p>考虑给出图是连通二分图(不连通可以拆成若干个连通块分开搞)的时候, 枚举二分图两边集合的颜色, 观察下0和1的数目对不对. 如果是对的, 接下来考虑如何找到最少步数.</p>
<p>对于两个点$u$和$v$, 令它们之间的最短路是$dis(u,v)$, 那么交换它们两个颜色的最少步数是$dis(u,v)$, 且存在一种交换序列不会破坏其它节点的颜色. 证明如下:</p>
<p>不妨设$u$的颜色是0, $v$的颜色是$1$, $u$到$v$的最短路是$u\rightarrow x_1 \rightarrow x_2 \rightarrow &#8230; \rightarrow x_s \rightarrow v$. 如果$u$和$x_1$颜色不一样, 直接交换它们即可. 否则找到第一个$i$使得$x_i$和$u$颜色不同, 通过下面交换操作$(x_i,x_{i-1})$, $(x_{i-1},x_{i-2})$, &#8230;, $(x_1,u)$就可以把$u$的颜色搞到$x_i$上. 重复上述过程, $u$和$v$的颜色就交换了, 而且显然路径上其它点的颜色保持不变.</p>
<p>知道交换次数是最短路之后, 我们只搞清楚枚举谁和谁交换即可. 显然这是一个二分图最小权匹配问题, 可以套用KM或者费用流解决. 至于方案构造, 上面的证明就已经提供了构造方案. 确定匹配之后, 找出最短路, 然后对应地操作即可.</p>
<p># Helter Skelter</p>
<p>可以注意到对于一个固定的$a$, 可行的$b$一定是一个区间. 如果我们把所有可行的$(a,b)$画在二维平面上, 可以观察到一个有趣的现象: 这个可行区域一定是连通的, 且上下界有一些和$x$轴$y$轴平行的线段组成. 如下图所示.</p>
<p><a href="http://bestcoder.hdu.edu.cn/blog/wp-content/uploads/2016/07/H.png"><img class="alignnone size-medium wp-image-385" src="http://bestcoder.hdu.edu.cn/blog/wp-content/uploads/2016/07/H-300x189.png" alt="H" width="300" height="189" srcset="http://bestcoder.hdu.edu.cn/blog/wp-content/uploads/2016/07/H-300x189.png 300w, http://bestcoder.hdu.edu.cn/blog/wp-content/uploads/2016/07/H.png 410w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>显然, 求出这个上下边界这道题目就搞定了. 考虑求下边界, 观察上图可以知道, 求出所有红色的点就可以确定这个下边界. 同样, 所有绿色的点就可以确定上边界. 一个显然的猜想就是这些边界点肯定是由一些连续的run组成的, 红色点的run肯定是从0开始, 以0结尾, 绿色则是从1开始, 以1结尾. 假装这个猜想是对的, 接下来就是枚举这些连续的run, 然后随便排序下这些点对, 利用类似凸包的方法就可以求出这些红色or绿色的点. 确定了上下边界之后, 对于一个询问$(a,b)$, 就可以二分出对应$b$的上下界.</p>
<p># It&#8217;s All In The Mind</p>
<p>令$x=a_1+a_2,y=a_3+a_4+&#8230;+a_n$, 那么$\frac{a_1+a_2}{a_1+a_2+&#8230;+a_n}=\frac{x}{x+y}=1-\frac{y}{x+y}$. 对于定值$y$, 显然$x$越大越好, 对于定值$x$, 显然$y$越小越好. 于是按照$a_1$和$a_2$尽量大, 其他元素尽量小的策略填数就好了.</p>
<p># Join The Future</p>
<p>对于题目给出的$m$个关系, 显然可以确定出一些等价类, 我们删掉只有一个元素的等价类, 那么显然剩下等价类的个数不超过$\frac{n}{2}$, 于是可以暴力$O(2^{\frac{n}{2}})$枚举剩下等价类的值, dp出对应的方案数. 字典序最小也可以在dp的过程中顺便计算出来.</p>
<p># Keep On Movin</p>
<p>如果每个字符出现次数都是偶数, 那么答案显然就是所有数的和. 对于奇数部分, 显然需要把其他字符均匀分配给这写奇数字符. 随便计算下就好了.</p>
<p># La Vie en rose</p>
<p>题目给出的变换规则其实就是交换相邻元素, 并且每个元素最多交换一次. 那么一个$O(nm)$的dp其实十分显然, $dp_{i,j,k}$表示匹配到$s$的第$i$个字符, $p$的第$j$个字符, $j$这一位的当前状态是$k$ (0表示和前面交换, 1表示没有交换, 2表示和后面交换). 转移方程如下:</p>
<p>$dp_{i,j,0}=dp_{i-1,j-1,2} \ and\ s_i = p_{j-1}$</p>
<p>$ dp_{i,j,1}=(dp_{i-1,j-1,0} \ or\  dp_{i-1,j-1,1}) \ and\ s_i = p_j $</p>
<p>$dp_{i,j,2}=(dp_{i-1,j-1,0} \ or \ dp_{i-1,j-1,1}) \ and \ s_i = t_{j+1}$</p>
<p>这个dp数组里面存的都是bool值, 可以考虑用bitset压缩这个dp数组中的第一维$i$, 然后滚动下第二维$j$, 就得到了到$O(\frac{nm}{w})$的做法, 其中$w$是机器的字节长.</p>
<p># Memento Mori</p>
<p>虽然这题长着像分类讨论, 但是实际上不需要分类讨论.</p>
<p>显然最终的子矩形的左右边界会被两个1卡住, 不妨考虑枚举这两个1. 枚举完之后, 可以发现根据和排列$p$的相对位置关系, 事实上其他2个1的位置也是确定了的. 剩下的问题是如何快速定位另外两个1.</p>
<p>先把所有的1按照行优先的顺序排序, 考虑枚举做边界$i$, 然后维护一个$i$右边的那些$1$的列坐标$c$的一个有序表, 按照$j$从大到小枚举右边界$j$, 同时维护这个有序表($j$枚举完之后删掉对应的列坐标), 那么显然只要根据$i$和$j$上下还需要几个1, 中间还需要几个1, 另外两个1就能够用$O(1)$时间在这个有序表上定位. 因为$i$和$j$在这个有序表上的位置我们可以事先维护好.</p>
<p>还需要注意同一行/列内有多个$1$的处理, 在维护有序表的同时加几个if就好了.</p>
					</div><!-- .entry-content -->
		
		<footer class="entry-meta">
			本条目发布于<a href="http://bestcoder.hdu.edu.cn/blog/2016-multi-university-training-contest-2-solutions-by-zimpha/" title="17:00" rel="bookmark"><time class="entry-date" datetime="2016-07-21T17:00:19+00:00">2016年7月21日</time></a>。属于<a href="http://bestcoder.hdu.edu.cn/blog/category/duoxiao/" rel="category tag">多校题解</a>分类。<span class="by-author">作者是<span class="author vcard"><a class="url fn n" href="http://bestcoder.hdu.edu.cn/blog/author/wange21/" title="查看所有由wange发布的文章" rel="author">wange</a></span>。</span>								</footer><!-- .entry-meta -->
	</article><!-- #post -->
							
	<article id="post-352" class="post-352 post type-post status-publish format-standard hentry category-duoxiao category-uncategorized">
				<header class="entry-header">
			
						<h1 class="entry-title">
				<a href="http://bestcoder.hdu.edu.cn/blog/2016-multi-university-training-contest-1-solutions-by-hit/" rel="bookmark">2016 Multi-University Training Contest 1 solutions BY HIT</a>
			</h1>
										<div class="comments-link">
					<a href="http://bestcoder.hdu.edu.cn/blog/2016-multi-university-training-contest-1-solutions-by-hit/#respond"><span class="leave-reply">发表回复</span></a>				</div><!-- .comments-link -->
					</header><!-- .entry-header -->

				<div class="entry-content">
			<h1 style="text-align: center;">2016 Multi-University Training Contest 1</h1>
<p class="Bodytext20" style="text-align: justify; text-justify: inter-ideograph; text-indent: 0cm; background: transparent; margin: 0cm 0cm 21.5pt 0cm;"><span lang="ZH-TW" style="color: black;">首先向大家表示抱歉，因为这套题是去年出的，中间间隔时间太长，今年又临时准备仓促， 所以部分题目出现了一些问题，非常抱歉。</span></p>
<h2>Abandoned country</h2>
<p>首先注意到任意两条边的边权是不一样的，由此得知最小生成树是唯一的，最小生成树既然 是唯一的，那么期望其实也就是唯一的，不存在什么最小期望。求完最小生成树之后，接下 来的问题就可以转换成在最小生成树上求任意两点之间距离的平均值，对于每条边，统计所 有的路径用到此边的次数，也就是边的两端的点数之积。那么这条边的总贡献就是次数*边 权。最后得到所有边的贡献之和再除以总路径数$n*(n-1)/2$就是答案。可以$On$求出。任取一点为根dfs，对每个点$i$记录其子树包含的点数（包括其自身），设点数为$sum[i]$，则$i$的父亲一侧的点数即为$n-sum[i]$。一边遍历一边统计就行。</p>
<h2>Chess</h2>
<p>简单的博弈，要预处理出所有状态的Sg值，因为列为固定的20,所以状态压缩后可以存下 所有状态。</p>
<h2>Game</h2>
<p>题目要求出所有合法点对间的最短路径的平均值，因此我们应当求出所有合法最短点对的最 短路径之和，再除以合法点对个数。 题目中Guard之间有着很不自然的制约关系，每个Guard的周围和同行、列都不能有其余的 Guard,但不可路过的格子却只有本身一格。由此发现，任意两点间的最短路径只会至多被 一个Guard所干扰。 因此可以想到，我们可以先算出没有Guard制约的所有最短路径长度之和，再分别对于每个 Guard求出它对最短路径长度的贡献（即原本必须经过它的最短路要多绕两格）。</p>
<h2>GCD</h2>
<p>我们注意观察$gcd(a_{l},a_{l+1},&#8230;,a_{r})$，当l固定不动的时候，$r=l&#8230;n$时，我们可以容易的发现,随着$r$的増大，$gcd(a_{l},a_{l+1},&#8230;,a_{r})$是递减的，同时$gcd(a_{l},a_{l+1},&#8230;,a_{r})$最多 有$log\ 1000,000,000$个不同的值，为什么呢？因为$a_{l}$最多也就有$log\ 1000,000,000$个质因数</p>
<p>所以我们可以在log级别的时间处理出所有的以L开头的左区间的$gcd(a_{l},a_{l+1},&#8230;,a_{r})$ 那么我们就可以在$n\ log\ 1000,000,000$的时间内预处理出所有的$gcd(a_{l},a_{l+1},&#8230;,a_{r})$然后我们可以用一个map来记录，gcd值为key的有多少个 然后我们就可以对于每个询问只需要查询对应$gcd(a_{l},a_{l+1},&#8230;,a_{r})$为多少，然后再在map 里面查找对应答案即可.</p>
<h2>Necklace</h2>
<p>其实就是一个阴阳宝石怎么交错摆放的问题，很容易想到通过DFS去搜索枚举，但是直接阴 阳交错搜索的话，时间复杂度太高，并且不容易通过估算估计代价去剪枝。 因此我们首先选取一种宝石（假设为阴），枚举所有的摆放情况，之后再依次枚举插入另一 种宝石（假设为阳），由于阴宝石己摆放好，则当前方案总代价就能有一个比较粗略但很有 效的估计：也就是每次枚举所有未插入的阳宝石，依次去插入到每一个空位中，只要存在一 个可以使其光泽变暗的空位，则认为它的光泽会变暗，由此可以得到一个当前方案的估计代 价，再采用此代价进行剪枝即可。</p>
<h2>PowMod</h2>
<p>考虑由于$\varphi (i)$是积性函数，因此我们对于每个质因子求出其贡献即可。</p>
<p>考虑$n$的某个质因子$p$,我们设$sum(n,m)=\sum_{i=1}^{m} \varphi (i*n)$.那么考虑将质因子$p$的贡献单独处 理，可以得到$\varphi (i*n) = \varphi (p) * \sum _{i=1}^{m} \varphi (i* \frac{n}{p}) + \sum_{i=1}^{m/p} \varphi (i*n)$.</p>
<p>因此可以利用$sum(n,m) = \varphi (p) * sum(\frac {n}{p},m) + sum(n,\frac{m}{p})$来递归地计算k.</p>
<p>最后可以利用$a^{b}\%p = a^{\varphi (p) + b\%\varphi (p)}$,递归地计算$k^{k^{k^{&#8230;^{k}}}}$</p>
<h2>Rigid Frameworks</h2>
<p>原问题等价于求左边有n个点，右边有m个点的联通的二分图的数目 可以用类似连通图计数的方法dp得到，复杂度$O(n6)$。</p>
<p>实际上是 projecteuler 434</p>
<h2>Shell Necklace</h2>
<p>设$f[i]$表示装饰前$i$个的代价，那么$f[i] = \sum_{j=1}^{i} f(i-j)*a[j]$。直接计算是$n^{2}$的，观察这个式子，显然符合$fft$的形式，所以用分治$fft$优化即可。</p>
<h2>Solid Dominoes Tilings</h2>
<p>回忆多米诺骨牌完美覆盖。</p>
<p>显然我们可以轮廓线DP。</p>
<p>swap(p, q); f[p].clear(); foreach(it, f[q]) {</p>
<p style="padding-left: 30px;">    d = it-&gt;se;</p>
<p style="padding-left: 30px;">   ints= it-&gt;fi;</p>
<p style="padding-left: 30px;">if(j &amp;&amp; !_1(s, j) &amp;&amp; _1(s, j-1))</p>
<p style="padding-left: 30px;">{</p>
<p style="padding-left: 30px;">      f[p][s&#8221;_1(j-1)] += d; // 横着放</p>
<p style="padding-left: 30px;">      f[p][s二1(j)] += d; // 竖着放或不放&#8230;</p>
<p style="padding-left: 30px;">}</p>
<p>} 稍加修改可以支持障碍以及空隙。</p>
<p>swap(p, q); f[p].clear(); foreach(it, f[q]) {</p>
<p style="padding-left: 30px;">d = it-&gt;se; ints = it-&gt;fi;</p>
<p style="padding-left: 30px;">if(buf[i1][j] != ’.’）{</p>
<p style="padding-left: 60px;">if(!_1(s, j)) f[p][s] += d; // 有障碍、必须不放</p>
<p>}</p>
<p style="padding-left: 30px;">else{</p>
<p style="padding-left: 60px;">if(j != j0 &amp;&amp; !_1(s, j) &amp;&amp; _1(s, j-1) &amp;&amp; buf[i1][j-1]==&#8217;.&#8217;)</p>
<p style="padding-left: 90px;">f[p][s二1(j-1)] += d; // 横着放</p>
<p style="padding-left: 60px;">if(!_1(s, j)){ //是否没被覆盖</p>
<p style="padding-left: 90px;">f[p][s] += d; // 不放</p>
<p style="padding-left: 90px;">f[p][s二1(j)] += d; // 竖着放</p>
<p style="padding-left: 60px;">}</p>
<p style="padding-left: 60px;">else{</p>
<p style="padding-left: 90px;">f[p][s二1(j)] += d; // 不放</p>
<p style="padding-left: 60px;">}</p>
<p style="padding-left: 30px;">}</p>
<p>}</p>
<p>。。。剩下只需要考虑solid的问题。。。</p>
<p>方法一：加维，复杂度太高。不适用这个题</p>
<p>方法二：容斥原理。</p>
<p>我们用上述方法先预处理不考虑分割线的状态。我们对列用容斥原理，枚举列上分割线的状态。</p>
<p>在用递推处理行分割的情况，复杂度$O(n\  2^{m})$。</p>
<h2>Subway</h2>
<p>这个题是一个树的同构判断，想办法用一个和节点顺序无关的哈希函数将树表示出来即可。 这里提供一种方法：首先求解树的中点，然后将中点作为根。只有一个结点的子树哈希值为 1。选一个比较大的质数P和一个特别大的质数Q。对于每一颗树，把它的所有子树的哈希 值排序。然后$hash=sum(P^{i}*hash[i])\%Q$，就能算出来总体的哈希值。有两个中点的树两个 中点都试一下。为了保险可以检查下哈希值有没有重的。</p>
<h2>tetrahedron</h2>
<p>设四个点是A、B、C、D ,那么内切球的圆心可以表示为 $\frac{ \begin{Vmatrix}(b-a)\times (c-a)\end{Vmatrix}\times d+\begin{Vmatrix}(b-a)\times (d-a)\end{Vmatrix}\times c + \begin{Vmatrix}(c-a)\times (d-a)\end{Vmatrix}\times b +\begin{Vmatrix}(c-b)\times (d-b)\end{Vmatrix}\times a }{  \begin{Vmatrix}(b-a)\times (c-a)\end{Vmatrix}+ \begin{Vmatrix}(b-a)\times (d-a)\end{Vmatrix} + \begin{Vmatrix}(c-a)\times (d-a)\end{Vmatrix} + \begin{Vmatrix}(c-b)\times (d-b)\end{Vmatrix}} $</p>
<p>半径$r =\frac{ \begin{Vmatrix} a_{x} &amp; a_{y} &amp;a_{z} &amp; 1\\ b_{x} &amp; b_{y} &amp;b_{z} &amp; 1\\ c_{x} &amp; c_{y} &amp;c_{z} &amp; 1\\ d_{x} &amp; d_{y} &amp;d_{z} &amp; 1 \end{Vmatrix} }{ \begin{Vmatrix}(b-a)\times (c-a)\end{Vmatrix}+ \begin{Vmatrix}(b-a)\times (d-a)\end{Vmatrix} + \begin{Vmatrix}(c-a)\times (d-a)\end{Vmatrix} + \begin{Vmatrix}(c-b)\times (d-b)\end{Vmatrix}} $</p>
					</div><!-- .entry-content -->
		
		<footer class="entry-meta">
			本条目发布于<a href="http://bestcoder.hdu.edu.cn/blog/2016-multi-university-training-contest-1-solutions-by-hit/" title="00:47" rel="bookmark"><time class="entry-date" datetime="2016-07-20T00:47:53+00:00">2016年7月20日</time></a>。属于<a href="http://bestcoder.hdu.edu.cn/blog/category/duoxiao/" rel="category tag">多校题解</a>、<a href="http://bestcoder.hdu.edu.cn/blog/category/uncategorized/" rel="category tag">未分类</a>分类。<span class="by-author">作者是<span class="author vcard"><a class="url fn n" href="http://bestcoder.hdu.edu.cn/blog/author/wange21/" title="查看所有由wange发布的文章" rel="author">wange</a></span>。</span>								</footer><!-- .entry-meta -->
	</article><!-- #post -->
			
					<nav id="nav-below" class="navigation" role="navigation">
			<h3 class="assistive-text">文章导航</h3>
			<div class="nav-previous"><a href="http://bestcoder.hdu.edu.cn/blog/page/2/" ><span class="meta-nav">&larr;</span> 早期文章</a></div>
			<div class="nav-next"></div>
		</nav><!-- .navigation -->
	
		
		</div><!-- #content -->
	</div><!-- #primary -->


			<div id="secondary" class="widget-area" role="complementary">
			<aside id="search-2" class="widget widget_search"><form role="search" method="get" id="searchform" class="searchform" action="http://bestcoder.hdu.edu.cn/blog/">
				<div>
					<label class="screen-reader-text" for="s">搜索：</label>
					<input type="text" value="" name="s" id="s" />
					<input type="submit" id="searchsubmit" value="搜索" />
				</div>
			</form></aside>		<aside id="recent-posts-2" class="widget widget_recent_entries">		<h3 class="widget-title">近期文章</h3>		<ul>
					<li>
				<a href="http://bestcoder.hdu.edu.cn/blog/2016-multi-university-training-contest-2-solutions-by-zimpha/">2016 Multi-University Training Contest 2 solutions BY zimpha</a>
						</li>
					<li>
				<a href="http://bestcoder.hdu.edu.cn/blog/2016-multi-university-training-contest-1-solutions-by-hit/">2016 Multi-University Training Contest 1 solutions BY HIT</a>
						</li>
					<li>
				<a href="http://bestcoder.hdu.edu.cn/blog/2015-acmicpc-asia-regional-shenyang-online-solution-document/">2015 ACM/ICPC Asia Regional Shenyang Online Solution Document</a>
						</li>
					<li>
				<a href="http://bestcoder.hdu.edu.cn/blog/2015-acmicpc-asia-regional-changchun-online-solution-document/">2015 ACM/ICPC Asia Regional Changchun Online Solution Document</a>
						</li>
					<li>
				<a href="http://bestcoder.hdu.edu.cn/blog/2015-multi-university-training-contest-10-solutions-by-kut%ef%bc%88dprk%ef%bc%89/">2015 Multi-University Training Contest 10 solutions BY KUT（DPRK）</a>
						</li>
				</ul>
		</aside>		<aside id="categories-2" class="widget widget_categories"><h3 class="widget-title">分类目录</h3>		<ul>
	<li class="cat-item cat-item-7"><a href="http://bestcoder.hdu.edu.cn/blog/category/acmicpc-asia-regional-%e7%bd%91%e8%b5%9b%e9%a2%98%e8%a7%a3/" >ACM/ICPC Asia Regional 网赛题解</a>
</li>
	<li class="cat-item cat-item-11"><a href="http://bestcoder.hdu.edu.cn/blog/category/duoxiao/" >多校题解</a>
</li>
	<li class="cat-item cat-item-1"><a href="http://bestcoder.hdu.edu.cn/blog/category/uncategorized/" >未分类</a>
</li>
		</ul>
</aside>		</div><!-- #secondary -->
		</div><!-- #main .wrapper -->
	<footer id="colophon" role="contentinfo">
		<div class="site-info">
						<a href="https://cn.wordpress.org/" title="优雅的个人发布平台">自豪地采用WordPress</a>
		</div><!-- .site-info -->
	</footer><!-- #colophon -->
</div><!-- #page -->
<script type='text/javascript' src='http://bestcoder.hdu.edu.cn/blog/wp-content/themes/twentytwelve/js/navigation.js?ver=20140711'></script>
<script type='text/javascript' src='http://bestcoder.hdu.edu.cn/blog/wp-includes/js/wp-embed.min.js?ver=4.5.3'></script>
</body>
</html>